{"ast":null,"code":"var _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nimport React, { Component } from 'react';\nimport IconButton from '@material-ui/core/IconButton';\nimport Fab from '@material-ui/core/Fab';\nimport HighlightOff from '@material-ui/icons/HighlightOff';\nimport Send from '@material-ui/icons/Send';\nimport './ChatComponent.css';\nimport { Tooltip } from '@material-ui/core';\n\nvar ChatComponent = function (_Component) {\n  _inherits(ChatComponent, _Component);\n\n  function ChatComponent(props) {\n    _classCallCheck(this, ChatComponent);\n\n    var _this = _possibleConstructorReturn(this, (ChatComponent.__proto__ || Object.getPrototypeOf(ChatComponent)).call(this, props));\n\n    _this.state = {\n      messageList: [],\n      message: ''\n    };\n    _this.chatScroll = React.createRef();\n    _this.handleChange = _this.handleChange.bind(_this);\n    _this.handlePressKey = _this.handlePressKey.bind(_this);\n    _this.close = _this.close.bind(_this);\n    _this.sendMessage = _this.sendMessage.bind(_this);\n    return _this;\n  }\n\n  _createClass(ChatComponent, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.props.user.getStreamManager().stream.session.on('signal:chat', function (event) {\n        var data = JSON.parse(event.data);\n        var messageList = _this2.state.messageList;\n        messageList.push({\n          connectionId: event.from.connectionId,\n          nickname: data.nickname,\n          message: data.message\n        });\n        var document = window.document;\n        setTimeout(function () {\n          var userImg = document.getElementById('userImg-' + (_this2.state.messageList.length - 1));\n          var video = document.getElementById('video-' + data.streamId);\n          var avatar = userImg.getContext('2d');\n          avatar.drawImage(video, 200, 120, 285, 285, 0, 0, 60, 60);\n\n          _this2.props.messageReceived();\n        }, 50);\n\n        _this2.setState({\n          messageList: messageList\n        });\n\n        _this2.scrollToBottom();\n      });\n    }\n  }, {\n    key: 'handleChange',\n    value: function handleChange(event) {\n      this.setState({\n        message: event.target.value\n      });\n    }\n  }, {\n    key: 'handlePressKey',\n    value: function handlePressKey(event) {\n      if (event.key === 'Enter') {\n        this.sendMessage();\n      }\n    }\n  }, {\n    key: 'sendMessage',\n    value: function sendMessage() {\n      console.log(this.state.message);\n\n      if (this.props.user && this.state.message) {\n        var message = this.state.message.replace(/ +(?= )/g, '');\n\n        if (message !== '' && message !== ' ') {\n          var data = {\n            message: message,\n            nickname: this.props.user.getNickname(),\n            streamId: this.props.user.getStreamManager().stream.streamId\n          };\n          this.props.user.getStreamManager().stream.session.signal({\n            data: JSON.stringify(data),\n            type: 'chat'\n          });\n        }\n      }\n\n      this.setState({\n        message: ''\n      });\n    }\n  }, {\n    key: 'scrollToBottom',\n    value: function scrollToBottom() {\n      var _this3 = this;\n\n      setTimeout(function () {\n        try {\n          _this3.chatScroll.current.scrollTop = _this3.chatScroll.current.scrollHeight;\n        } catch (err) {}\n      }, 20);\n    }\n  }, {\n    key: 'close',\n    value: function close() {\n      this.props.close(undefined);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this4 = this;\n\n      var styleChat = {\n        display: this.props.chatDisplay\n      };\n      return React.createElement('div', {\n        id: 'chatContainer'\n      }, React.createElement('div', {\n        id: 'chatComponent',\n        style: styleChat\n      }, React.createElement('div', {\n        id: 'chatToolbar'\n      }, React.createElement('span', null, this.props.user.getStreamManager().stream.session.sessionId, ' - CHAT'), React.createElement(IconButton, {\n        id: 'closeButton',\n        onClick: this.close\n      }, React.createElement(HighlightOff, {\n        color: 'secondary'\n      }))), React.createElement('div', {\n        className: 'message-wrap',\n        ref: this.chatScroll\n      }, this.state.messageList.map(function (data, i) {\n        return React.createElement('div', {\n          key: i,\n          id: 'remoteUsers',\n          className: 'message' + (data.connectionId !== _this4.props.user.getConnectionId() ? ' left' : ' right')\n        }, React.createElement('canvas', {\n          id: 'userImg-' + i,\n          width: '60',\n          height: '60',\n          className: 'user-img'\n        }), React.createElement('div', {\n          className: 'msg-detail'\n        }, React.createElement('div', {\n          className: 'msg-info'\n        }, React.createElement('p', null, ' ', data.nickname)), React.createElement('div', {\n          className: 'msg-content'\n        }, React.createElement('span', {\n          className: 'triangle'\n        }), React.createElement('p', {\n          className: 'text'\n        }, data.message))));\n      })), React.createElement('div', {\n        id: 'messageInput'\n      }, React.createElement('input', {\n        placeholder: 'Send a messge',\n        id: 'chatInput',\n        value: this.state.message,\n        onChange: this.handleChange,\n        onKeyPress: this.handlePressKey\n      }), React.createElement(Tooltip, {\n        title: 'Send message'\n      }, React.createElement(Fab, {\n        size: 'small',\n        id: 'sendButton',\n        onClick: this.sendMessage\n      }, React.createElement(Send, null))))));\n    }\n  }]);\n\n  return ChatComponent;\n}(Component);\n\nexport default ChatComponent;","map":{"version":3,"sources":["/home/trongtu/Documents/ki 2 nam 3/CongNgheWeb/baitaplon/baitaplon_frontend/node_modules/openvidu-react/dist/components/chat/ChatComponent.js"],"names":["_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","create","constructor","value","setPrototypeOf","__proto__","React","Component","IconButton","Fab","HighlightOff","Send","Tooltip","ChatComponent","_Component","_this","getPrototypeOf","state","messageList","message","chatScroll","createRef","handleChange","bind","handlePressKey","close","sendMessage","componentDidMount","_this2","user","getStreamManager","stream","session","on","event","data","JSON","parse","push","connectionId","from","nickname","document","window","setTimeout","userImg","getElementById","video","streamId","avatar","getContext","drawImage","messageReceived","setState","scrollToBottom","console","log","replace","getNickname","signal","stringify","type","_this3","current","scrollTop","scrollHeight","err","undefined","render","_this4","styleChat","display","chatDisplay","createElement","id","style","sessionId","onClick","color","className","ref","map","getConnectionId","width","height","placeholder","onChange","onKeyPress","title","size"],"mappings":"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","sourcesContent":["var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component } from 'react';\nimport IconButton from '@material-ui/core/IconButton';\nimport Fab from '@material-ui/core/Fab';\nimport HighlightOff from '@material-ui/icons/HighlightOff';\nimport Send from '@material-ui/icons/Send';\n\nimport './ChatComponent.css';\nimport { Tooltip } from '@material-ui/core';\n\nvar ChatComponent = function (_Component) {\n    _inherits(ChatComponent, _Component);\n\n    function ChatComponent(props) {\n        _classCallCheck(this, ChatComponent);\n\n        var _this = _possibleConstructorReturn(this, (ChatComponent.__proto__ || Object.getPrototypeOf(ChatComponent)).call(this, props));\n\n        _this.state = {\n            messageList: [],\n            message: ''\n        };\n        _this.chatScroll = React.createRef();\n\n        _this.handleChange = _this.handleChange.bind(_this);\n        _this.handlePressKey = _this.handlePressKey.bind(_this);\n        _this.close = _this.close.bind(_this);\n        _this.sendMessage = _this.sendMessage.bind(_this);\n        return _this;\n    }\n\n    _createClass(ChatComponent, [{\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            var _this2 = this;\n\n            this.props.user.getStreamManager().stream.session.on('signal:chat', function (event) {\n                var data = JSON.parse(event.data);\n                var messageList = _this2.state.messageList;\n                messageList.push({ connectionId: event.from.connectionId, nickname: data.nickname, message: data.message });\n                var document = window.document;\n                setTimeout(function () {\n                    var userImg = document.getElementById('userImg-' + (_this2.state.messageList.length - 1));\n                    var video = document.getElementById('video-' + data.streamId);\n                    var avatar = userImg.getContext('2d');\n                    avatar.drawImage(video, 200, 120, 285, 285, 0, 0, 60, 60);\n                    _this2.props.messageReceived();\n                }, 50);\n                _this2.setState({ messageList: messageList });\n                _this2.scrollToBottom();\n            });\n        }\n    }, {\n        key: 'handleChange',\n        value: function handleChange(event) {\n            this.setState({ message: event.target.value });\n        }\n    }, {\n        key: 'handlePressKey',\n        value: function handlePressKey(event) {\n            if (event.key === 'Enter') {\n                this.sendMessage();\n            }\n        }\n    }, {\n        key: 'sendMessage',\n        value: function sendMessage() {\n            console.log(this.state.message);\n            if (this.props.user && this.state.message) {\n                var message = this.state.message.replace(/ +(?= )/g, '');\n                if (message !== '' && message !== ' ') {\n                    var data = { message: message, nickname: this.props.user.getNickname(), streamId: this.props.user.getStreamManager().stream.streamId };\n                    this.props.user.getStreamManager().stream.session.signal({\n                        data: JSON.stringify(data),\n                        type: 'chat'\n                    });\n                }\n            }\n            this.setState({ message: '' });\n        }\n    }, {\n        key: 'scrollToBottom',\n        value: function scrollToBottom() {\n            var _this3 = this;\n\n            setTimeout(function () {\n                try {\n                    _this3.chatScroll.current.scrollTop = _this3.chatScroll.current.scrollHeight;\n                } catch (err) {}\n            }, 20);\n        }\n    }, {\n        key: 'close',\n        value: function close() {\n            this.props.close(undefined);\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _this4 = this;\n\n            var styleChat = { display: this.props.chatDisplay };\n            return React.createElement(\n                'div',\n                { id: 'chatContainer' },\n                React.createElement(\n                    'div',\n                    { id: 'chatComponent', style: styleChat },\n                    React.createElement(\n                        'div',\n                        { id: 'chatToolbar' },\n                        React.createElement(\n                            'span',\n                            null,\n                            this.props.user.getStreamManager().stream.session.sessionId,\n                            ' - CHAT'\n                        ),\n                        React.createElement(\n                            IconButton,\n                            { id: 'closeButton', onClick: this.close },\n                            React.createElement(HighlightOff, { color: 'secondary' })\n                        )\n                    ),\n                    React.createElement(\n                        'div',\n                        { className: 'message-wrap', ref: this.chatScroll },\n                        this.state.messageList.map(function (data, i) {\n                            return React.createElement(\n                                'div',\n                                {\n                                    key: i,\n                                    id: 'remoteUsers',\n                                    className: 'message' + (data.connectionId !== _this4.props.user.getConnectionId() ? ' left' : ' right')\n                                },\n                                React.createElement('canvas', { id: 'userImg-' + i, width: '60', height: '60', className: 'user-img' }),\n                                React.createElement(\n                                    'div',\n                                    { className: 'msg-detail' },\n                                    React.createElement(\n                                        'div',\n                                        { className: 'msg-info' },\n                                        React.createElement(\n                                            'p',\n                                            null,\n                                            ' ',\n                                            data.nickname\n                                        )\n                                    ),\n                                    React.createElement(\n                                        'div',\n                                        { className: 'msg-content' },\n                                        React.createElement('span', { className: 'triangle' }),\n                                        React.createElement(\n                                            'p',\n                                            { className: 'text' },\n                                            data.message\n                                        )\n                                    )\n                                )\n                            );\n                        })\n                    ),\n                    React.createElement(\n                        'div',\n                        { id: 'messageInput' },\n                        React.createElement('input', {\n                            placeholder: 'Send a messge',\n                            id: 'chatInput',\n                            value: this.state.message,\n                            onChange: this.handleChange,\n                            onKeyPress: this.handlePressKey\n                        }),\n                        React.createElement(\n                            Tooltip,\n                            { title: 'Send message' },\n                            React.createElement(\n                                Fab,\n                                { size: 'small', id: 'sendButton', onClick: this.sendMessage },\n                                React.createElement(Send, null)\n                            )\n                        )\n                    )\n                )\n            );\n        }\n    }]);\n\n    return ChatComponent;\n}(Component);\n\nexport default ChatComponent;"]},"metadata":{},"sourceType":"module"}