{"ast":null,"code":"var _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport './VideoRoomComponent.css';\nimport { OpenVidu } from 'openvidu-browser';\nimport StreamComponent from './stream/StreamComponent';\nimport DialogExtensionComponent from './dialog-extension/DialogExtension';\nimport ChatComponent from './chat/ChatComponent';\nimport OpenViduLayout from '../layout/openvidu-layout';\nimport UserModel from '../models/user-model';\nimport ToolbarComponent from './toolbar/ToolbarComponent';\nvar localUser = new UserModel();\n\nvar VideoRoomComponent = function (_Component) {\n  _inherits(VideoRoomComponent, _Component);\n\n  function VideoRoomComponent(props) {\n    _classCallCheck(this, VideoRoomComponent);\n\n    var _this = _possibleConstructorReturn(this, (VideoRoomComponent.__proto__ || Object.getPrototypeOf(VideoRoomComponent)).call(this, props));\n\n    _this.OPENVIDU_SERVER_URL = _this.props.openviduServerUrl ? _this.props.openviduServerUrl : 'https://' + window.location.hostname + ':4443';\n    _this.OPENVIDU_SERVER_SECRET = _this.props.openviduSecret ? _this.props.openviduSecret : 'MY_SECRET';\n    _this.hasBeenUpdated = false;\n    _this.layout = new OpenViduLayout();\n    var sessionName = _this.props.sessionName ? _this.props.sessionName : 'SessionA';\n    var userName = _this.props.user ? _this.props.user : 'OpenVidu_User' + Math.floor(Math.random() * 100);\n    _this.state = {\n      mySessionId: sessionName,\n      myUserName: userName,\n      session: undefined,\n      localUser: undefined,\n      subscribers: [],\n      chatDisplay: 'none'\n    };\n    _this.joinSession = _this.joinSession.bind(_this);\n    _this.leaveSession = _this.leaveSession.bind(_this);\n    _this.onbeforeunload = _this.onbeforeunload.bind(_this);\n    _this.updateLayout = _this.updateLayout.bind(_this);\n    _this.camStatusChanged = _this.camStatusChanged.bind(_this);\n    _this.micStatusChanged = _this.micStatusChanged.bind(_this);\n    _this.nicknameChanged = _this.nicknameChanged.bind(_this);\n    _this.toggleFullscreen = _this.toggleFullscreen.bind(_this);\n    _this.screenShare = _this.screenShare.bind(_this);\n    _this.stopScreenShare = _this.stopScreenShare.bind(_this);\n    _this.closeDialogExtension = _this.closeDialogExtension.bind(_this);\n    _this.toggleChat = _this.toggleChat.bind(_this);\n    _this.checkNotification = _this.checkNotification.bind(_this);\n    _this.checkSize = _this.checkSize.bind(_this);\n    return _this;\n  }\n\n  _createClass(VideoRoomComponent, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var openViduLayoutOptions = {\n        maxRatio: 3 / 2,\n        // The narrowest ratio that will be used (default 2x3)\n        minRatio: 9 / 16,\n        // The widest ratio that will be used (default 16x9)\n        fixedRatio: false,\n        // If this is true then the aspect ratio of the video is maintained and minRatio and maxRatio are ignored (default false)\n        bigClass: 'OV_big',\n        // The class to add to elements that should be sized bigger\n        bigPercentage: 0.8,\n        // The maximum percentage of space the big ones should take up\n        bigFixedRatio: false,\n        // fixedRatio for the big ones\n        bigMaxRatio: 3 / 2,\n        // The narrowest ratio to use for the big elements (default 2x3)\n        bigMinRatio: 9 / 16,\n        // The widest ratio to use for the big elements (default 16x9)\n        bigFirst: true,\n        // Whether to place the big one in the top left (true) or bottom right\n        animate: true // Whether you want to animate the transitions\n\n      };\n      this.layout.initLayoutContainer(document.getElementById('layout'), openViduLayoutOptions);\n      window.addEventListener('beforeunload', this.onbeforeunload);\n      window.addEventListener('resize', this.updateLayout);\n      window.addEventListener('resize', this.checkSize);\n      this.joinSession();\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      window.removeEventListener('beforeunload', this.onbeforeunload);\n      window.removeEventListener('resize', this.updateLayout);\n      window.removeEventListener('resize', this.checkSize);\n      this.leaveSession();\n    }\n  }, {\n    key: 'onbeforeunload',\n    value: function onbeforeunload(event) {\n      this.leaveSession();\n    }\n  }, {\n    key: 'joinSession',\n    value: function joinSession() {\n      var _this2 = this;\n\n      this.OV = new OpenVidu();\n      this.setState({\n        session: this.OV.initSession()\n      }, function () {\n        _this2.subscribeToStreamCreated();\n\n        _this2.connectToSession();\n      });\n    }\n  }, {\n    key: 'connectToSession',\n    value: function connectToSession() {\n      var _this3 = this;\n\n      if (this.props.token !== undefined) {\n        console.log('token received: ', this.props.token);\n        this.connect(this.props.token);\n      } else {\n        this.getToken().then(function (token) {\n          console.log(token);\n\n          _this3.connect(token);\n        }).catch(function (error) {\n          if (_this3.props.error) {\n            _this3.props.error({\n              error: error.error,\n              messgae: error.message,\n              code: error.code,\n              status: error.status\n            });\n          }\n\n          console.log('There was an error getting the token:', error.code, error.message);\n          alert('There was an error getting the token:', error.message);\n        });\n      }\n    }\n  }, {\n    key: 'connect',\n    value: function connect(token) {\n      var _this4 = this;\n\n      this.state.session.connect(token, {\n        clientData: this.state.myUserName\n      }).then(function () {\n        _this4.connectWebCam();\n      }).catch(function (error) {\n        if (_this4.props.error) {\n          _this4.props.error({\n            error: error.error,\n            messgae: error.message,\n            code: error.code,\n            status: error.status\n          });\n        }\n\n        alert('There was an error connecting to the session:', error.message);\n        console.log('There was an error connecting to the session:', error.code, error.message);\n      });\n    }\n  }, {\n    key: 'connectWebCam',\n    value: function connectWebCam() {\n      var _this5 = this;\n\n      var publisher = this.OV.initPublisher(undefined, {\n        audioSource: undefined,\n        videoSource: undefined,\n        publishAudio: localUser.isAudioActive(),\n        publishVideo: localUser.isVideoActive(),\n        resolution: '640x480',\n        frameRate: 30,\n        insertMode: 'APPEND'\n      });\n\n      if (this.state.session.capabilities.publish) {\n        this.state.session.publish(publisher).then(function () {\n          if (_this5.props.joinSession) {\n            _this5.props.joinSession();\n          }\n        });\n      }\n\n      localUser.setNickname(this.state.myUserName);\n      localUser.setConnectionId(this.state.session.connection.connectionId);\n      localUser.setScreenShareActive(false);\n      localUser.setStreamManager(publisher);\n      this.subscribeToUserChanged();\n      this.subscribeToStreamDestroyed();\n      this.sendSignalUserChanged({\n        isScreenShareActive: localUser.isScreenShareActive()\n      });\n      this.setState({\n        localUser: localUser\n      }, function () {\n        _this5.state.localUser.getStreamManager().on('streamPlaying', function (e) {\n          _this5.updateLayout();\n\n          publisher.videos[0].video.parentElement.classList.remove('custom-class');\n        });\n      });\n    }\n  }, {\n    key: 'leaveSession',\n    value: function leaveSession() {\n      var mySession = this.state.session;\n\n      if (mySession) {\n        mySession.disconnect();\n      } // Empty all properties...\n\n\n      this.OV = null;\n      this.setState({\n        session: undefined,\n        subscribers: [],\n        mySessionId: 'SessionA',\n        myUserName: 'OpenVidu_User' + Math.floor(Math.random() * 100),\n        localUser: undefined\n      });\n\n      if (this.props.leaveSession) {\n        this.props.leaveSession();\n      }\n    }\n  }, {\n    key: 'camStatusChanged',\n    value: function camStatusChanged() {\n      localUser.setVideoActive(!localUser.isVideoActive());\n      localUser.getStreamManager().publishVideo(localUser.isVideoActive());\n      this.sendSignalUserChanged({\n        isVideoActive: localUser.isVideoActive()\n      });\n      this.setState({\n        localUser: localUser\n      });\n    }\n  }, {\n    key: 'micStatusChanged',\n    value: function micStatusChanged() {\n      localUser.setAudioActive(!localUser.isAudioActive());\n      localUser.getStreamManager().publishAudio(localUser.isAudioActive());\n      this.sendSignalUserChanged({\n        isAudioActive: localUser.isAudioActive()\n      });\n      this.setState({\n        localUser: localUser\n      });\n    }\n  }, {\n    key: 'nicknameChanged',\n    value: function nicknameChanged(nickname) {\n      var localUser = this.state.localUser;\n      localUser.setNickname(nickname);\n      this.setState({\n        localUser: localUser\n      });\n      this.sendSignalUserChanged({\n        nickname: this.state.localUser.getNickname()\n      });\n    }\n  }, {\n    key: 'deleteSubscriber',\n    value: function deleteSubscriber(stream) {\n      var remoteUsers = this.state.subscribers;\n      var userStream = remoteUsers.filter(function (user) {\n        return user.getStreamManager().stream === stream;\n      })[0];\n      var index = remoteUsers.indexOf(userStream, 0);\n\n      if (index > -1) {\n        remoteUsers.splice(index, 1);\n        this.setState({\n          subscribers: remoteUsers\n        });\n      }\n    }\n  }, {\n    key: 'subscribeToStreamCreated',\n    value: function subscribeToStreamCreated() {\n      var _this6 = this;\n\n      this.state.session.on('streamCreated', function (event) {\n        var subscriber = _this6.state.session.subscribe(event.stream, undefined);\n\n        var subscribers = _this6.state.subscribers;\n        subscriber.on('streamPlaying', function (e) {\n          _this6.checkSomeoneShareScreen();\n\n          subscriber.videos[0].video.parentElement.classList.remove('custom-class');\n        });\n        var newUser = new UserModel();\n        newUser.setStreamManager(subscriber);\n        newUser.setConnectionId(event.stream.connection.connectionId);\n        newUser.setType('remote');\n        var nickname = event.stream.connection.data.split('%')[0];\n        newUser.setNickname(JSON.parse(nickname).clientData);\n        subscribers.push(newUser);\n\n        _this6.setState({\n          subscribers: subscribers\n        }, function () {\n          if (_this6.state.localUser) {\n            _this6.sendSignalUserChanged({\n              isAudioActive: _this6.state.localUser.isAudioActive(),\n              isVideoActive: _this6.state.localUser.isVideoActive(),\n              nickname: _this6.state.localUser.getNickname(),\n              isScreenShareActive: _this6.state.localUser.isScreenShareActive()\n            });\n          }\n\n          _this6.updateLayout();\n        });\n      });\n    }\n  }, {\n    key: 'subscribeToStreamDestroyed',\n    value: function subscribeToStreamDestroyed() {\n      var _this7 = this; // On every Stream destroyed...\n\n\n      this.state.session.on('streamDestroyed', function (event) {\n        // Remove the stream from 'subscribers' array\n        _this7.deleteSubscriber(event.stream);\n\n        setTimeout(function () {\n          _this7.checkSomeoneShareScreen();\n        }, 20);\n        event.preventDefault();\n\n        _this7.updateLayout();\n      });\n    }\n  }, {\n    key: 'subscribeToUserChanged',\n    value: function subscribeToUserChanged() {\n      var _this8 = this;\n\n      this.state.session.on('signal:userChanged', function (event) {\n        var remoteUsers = _this8.state.subscribers;\n        remoteUsers.forEach(function (user) {\n          if (user.getConnectionId() === event.from.connectionId) {\n            var data = JSON.parse(event.data);\n            console.log('EVENTO REMOTE: ', event.data);\n\n            if (data.isAudioActive !== undefined) {\n              user.setAudioActive(data.isAudioActive);\n            }\n\n            if (data.isVideoActive !== undefined) {\n              user.setVideoActive(data.isVideoActive);\n            }\n\n            if (data.nickname !== undefined) {\n              user.setNickname(data.nickname);\n            }\n\n            if (data.isScreenShareActive !== undefined) {\n              user.setScreenShareActive(data.isScreenShareActive);\n            }\n          }\n        });\n\n        _this8.setState({\n          subscribers: remoteUsers\n        }, function () {\n          return _this8.checkSomeoneShareScreen();\n        });\n      });\n    }\n  }, {\n    key: 'updateLayout',\n    value: function updateLayout() {\n      var _this9 = this;\n\n      setTimeout(function () {\n        _this9.layout.updateLayout();\n      }, 20);\n    }\n  }, {\n    key: 'sendSignalUserChanged',\n    value: function sendSignalUserChanged(data) {\n      var signalOptions = {\n        data: JSON.stringify(data),\n        type: 'userChanged'\n      };\n      this.state.session.signal(signalOptions);\n    }\n  }, {\n    key: 'toggleFullscreen',\n    value: function toggleFullscreen() {\n      var document = window.document;\n      var fs = document.getElementById('container');\n\n      if (!document.fullscreenElement && !document.mozFullScreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement) {\n        if (fs.requestFullscreen) {\n          fs.requestFullscreen();\n        } else if (fs.msRequestFullscreen) {\n          fs.msRequestFullscreen();\n        } else if (fs.mozRequestFullScreen) {\n          fs.mozRequestFullScreen();\n        } else if (fs.webkitRequestFullscreen) {\n          fs.webkitRequestFullscreen();\n        }\n      } else {\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.msExitFullscreen) {\n          document.msExitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        }\n      }\n    }\n  }, {\n    key: 'screenShare',\n    value: function screenShare() {\n      var _this10 = this;\n\n      var videoSource = navigator.userAgent.indexOf('Firefox') !== -1 ? 'window' : 'screen';\n      var publisher = this.OV.initPublisher(undefined, {\n        videoSource: videoSource,\n        publishAudio: localUser.isAudioActive(),\n        publishVideo: localUser.isVideoActive(),\n        mirror: false\n      }, function (error) {\n        if (error && error.name === 'SCREEN_EXTENSION_NOT_INSTALLED') {\n          _this10.setState({\n            showExtensionDialog: true\n          });\n        } else if (error && error.name === 'SCREEN_SHARING_NOT_SUPPORTED') {\n          alert('Your browser does not support screen sharing');\n        } else if (error && error.name === 'SCREEN_EXTENSION_DISABLED') {\n          alert('You need to enable screen sharing extension');\n        } else if (error && error.name === 'SCREEN_CAPTURE_DENIED') {\n          alert('You need to choose a window or application to share');\n        }\n      });\n      publisher.once('accessAllowed', function () {\n        _this10.state.session.unpublish(localUser.getStreamManager());\n\n        localUser.setStreamManager(publisher);\n\n        _this10.state.session.publish(localUser.getStreamManager()).then(function () {\n          localUser.setScreenShareActive(true);\n\n          _this10.setState({\n            localUser: localUser\n          }, function () {\n            _this10.sendSignalUserChanged({\n              isScreenShareActive: localUser.isScreenShareActive()\n            });\n          });\n        });\n      });\n      publisher.on('streamPlaying', function () {\n        _this10.updateLayout();\n\n        publisher.videos[0].video.parentElement.classList.remove('custom-class');\n      });\n    }\n  }, {\n    key: 'closeDialogExtension',\n    value: function closeDialogExtension() {\n      this.setState({\n        showExtensionDialog: false\n      });\n    }\n  }, {\n    key: 'stopScreenShare',\n    value: function stopScreenShare() {\n      this.state.session.unpublish(localUser.getStreamManager());\n      this.connectWebCam();\n    }\n  }, {\n    key: 'checkSomeoneShareScreen',\n    value: function checkSomeoneShareScreen() {\n      var isScreenShared = void 0; // return true if at least one passes the test\n\n      isScreenShared = this.state.subscribers.some(function (user) {\n        return user.isScreenShareActive();\n      }) || localUser.isScreenShareActive();\n      var openviduLayoutOptions = {\n        maxRatio: 3 / 2,\n        minRatio: 9 / 16,\n        fixedRatio: isScreenShared,\n        bigClass: 'OV_big',\n        bigPercentage: 0.8,\n        bigFixedRatio: false,\n        bigMaxRatio: 3 / 2,\n        bigMinRatio: 9 / 16,\n        bigFirst: true,\n        animate: true\n      };\n      this.layout.setLayoutOptions(openviduLayoutOptions);\n      this.updateLayout();\n    }\n  }, {\n    key: 'toggleChat',\n    value: function toggleChat(property) {\n      var display = property;\n\n      if (display === undefined) {\n        display = this.state.chatDisplay === 'none' ? 'block' : 'none';\n      }\n\n      if (display === 'block') {\n        this.setState({\n          chatDisplay: display,\n          messageReceived: false\n        });\n      } else {\n        console.log('chat', display);\n        this.setState({\n          chatDisplay: display\n        });\n      }\n\n      this.updateLayout();\n    }\n  }, {\n    key: 'checkNotification',\n    value: function checkNotification(event) {\n      this.setState({\n        messageReceived: this.state.chatDisplay === 'none'\n      });\n    }\n  }, {\n    key: 'checkSize',\n    value: function checkSize() {\n      if (document.getElementById('layout').offsetWidth <= 700 && !this.hasBeenUpdated) {\n        this.toggleChat('none');\n        this.hasBeenUpdated = true;\n      }\n\n      if (document.getElementById('layout').offsetWidth > 700 && this.hasBeenUpdated) {\n        this.hasBeenUpdated = false;\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var mySessionId = this.state.mySessionId;\n      var localUser = this.state.localUser;\n      var chatDisplay = {\n        display: this.state.chatDisplay\n      };\n      return React.createElement('div', {\n        className: 'container',\n        id: 'container'\n      }, React.createElement(ToolbarComponent, {\n        sessionId: mySessionId,\n        user: localUser,\n        showNotification: this.state.messageReceived,\n        camStatusChanged: this.camStatusChanged,\n        micStatusChanged: this.micStatusChanged,\n        screenShare: this.screenShare,\n        stopScreenShare: this.stopScreenShare,\n        toggleFullscreen: this.toggleFullscreen,\n        leaveSession: this.leaveSession,\n        toggleChat: this.toggleChat\n      }), React.createElement(DialogExtensionComponent, {\n        showDialog: this.state.showExtensionDialog,\n        cancelClicked: this.closeDialogExtension\n      }), React.createElement('div', {\n        id: 'layout',\n        className: 'bounds'\n      }, localUser !== undefined && localUser.getStreamManager() !== undefined && React.createElement('div', {\n        className: 'OT_root OT_publisher custom-class',\n        id: 'localUser'\n      }, React.createElement(StreamComponent, {\n        user: localUser,\n        handleNickname: this.nicknameChanged\n      })), this.state.subscribers.map(function (sub, i) {\n        return React.createElement('div', {\n          key: i,\n          className: 'OT_root OT_publisher custom-class',\n          id: 'remoteUsers'\n        }, React.createElement(StreamComponent, {\n          user: sub,\n          streamId: sub.streamManager.stream.streamId\n        }));\n      }), localUser !== undefined && localUser.getStreamManager() !== undefined && React.createElement('div', {\n        className: 'OT_root OT_publisher custom-class',\n        style: chatDisplay\n      }, React.createElement(ChatComponent, {\n        user: localUser,\n        chatDisplay: this.state.chatDisplay,\n        close: this.toggleChat,\n        messageReceived: this.checkNotification\n      }))));\n    }\n    /**\n     * --------------------------\n     * SERVER-SIDE RESPONSIBILITY\n     * --------------------------\n     * These methods retrieve the mandatory user token from OpenVidu Server.\n     * This behaviour MUST BE IN YOUR SERVER-SIDE IN PRODUCTION (by using\n     * the API REST, openvidu-java-client or openvidu-node-client):\n     *   1) Initialize a session in OpenVidu Server\t(POST /api/sessions)\n     *   2) Generate a token in OpenVidu Server\t\t(POST /api/tokens)\n     *   3) The token must be consumed in Session.connect() method\n     */\n\n  }, {\n    key: 'getToken',\n    value: function getToken() {\n      var _this11 = this;\n\n      return this.createSession(this.state.mySessionId).then(function (sessionId) {\n        return _this11.createToken(sessionId);\n      });\n    }\n  }, {\n    key: 'createSession',\n    value: function createSession(sessionId) {\n      var _this12 = this;\n\n      return new Promise(function (resolve, reject) {\n        var data = JSON.stringify({\n          customSessionId: sessionId\n        });\n        axios.post(_this12.OPENVIDU_SERVER_URL + '/api/sessions', data, {\n          headers: {\n            Authorization: 'Basic ' + btoa('OPENVIDUAPP:' + _this12.OPENVIDU_SERVER_SECRET),\n            'Content-Type': 'application/json'\n          }\n        }).then(function (response) {\n          console.log('CREATE SESION', response);\n          resolve(response.data.id);\n        }).catch(function (response) {\n          var error = Object.assign({}, response);\n\n          if (error.response && error.response.status === 409) {\n            resolve(sessionId);\n          } else {\n            console.log(error);\n            console.warn('No connection to OpenVidu Server. This may be a certificate error at ' + _this12.OPENVIDU_SERVER_URL);\n\n            if (window.confirm('No connection to OpenVidu Server. This may be a certificate error at \"' + _this12.OPENVIDU_SERVER_URL + '\"\\n\\nClick OK to navigate and accept it. ' + 'If no certificate warning is shown, then check that your OpenVidu Server is up and running at \"' + _this12.OPENVIDU_SERVER_URL + '\"')) {\n              window.location.assign(_this12.OPENVIDU_SERVER_URL + '/accept-certificate');\n            }\n          }\n        });\n      });\n    }\n  }, {\n    key: 'createToken',\n    value: function createToken(sessionId) {\n      var _this13 = this;\n\n      return new Promise(function (resolve, reject) {\n        var data = JSON.stringify({\n          session: sessionId\n        });\n        axios.post(_this13.OPENVIDU_SERVER_URL + '/api/tokens', data, {\n          headers: {\n            Authorization: 'Basic ' + btoa('OPENVIDUAPP:' + _this13.OPENVIDU_SERVER_SECRET),\n            'Content-Type': 'application/json'\n          }\n        }).then(function (response) {\n          console.log('TOKEN', response);\n          resolve(response.data.token);\n        }).catch(function (error) {\n          return reject(error);\n        });\n      });\n    }\n  }]);\n\n  return VideoRoomComponent;\n}(Component);\n\nexport default VideoRoomComponent;","map":{"version":3,"sources":["/home/trongtu/Downloads/baitaplon/node_modules/openvidu-react/dist/components/VideoRoomComponent.js"],"names":["_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","create","constructor","value","setPrototypeOf","__proto__","React","Component","axios","OpenVidu","StreamComponent","DialogExtensionComponent","ChatComponent","OpenViduLayout","UserModel","ToolbarComponent","localUser","VideoRoomComponent","_Component","_this","getPrototypeOf","OPENVIDU_SERVER_URL","openviduServerUrl","window","location","hostname","OPENVIDU_SERVER_SECRET","openviduSecret","hasBeenUpdated","layout","sessionName","userName","user","Math","floor","random","state","mySessionId","myUserName","session","undefined","subscribers","chatDisplay","joinSession","bind","leaveSession","onbeforeunload","updateLayout","camStatusChanged","micStatusChanged","nicknameChanged","toggleFullscreen","screenShare","stopScreenShare","closeDialogExtension","toggleChat","checkNotification","checkSize","componentDidMount","openViduLayoutOptions","maxRatio","minRatio","fixedRatio","bigClass","bigPercentage","bigFixedRatio","bigMaxRatio","bigMinRatio","bigFirst","animate","initLayoutContainer","document","getElementById","addEventListener","componentWillUnmount","removeEventListener","event","_this2","OV","setState","initSession","subscribeToStreamCreated","connectToSession","_this3","token","console","log","connect","getToken","then","catch","error","messgae","message","code","status","alert","_this4","clientData","connectWebCam","_this5","publisher","initPublisher","audioSource","videoSource","publishAudio","isAudioActive","publishVideo","isVideoActive","resolution","frameRate","insertMode","capabilities","publish","setNickname","setConnectionId","connection","connectionId","setScreenShareActive","setStreamManager","subscribeToUserChanged","subscribeToStreamDestroyed","sendSignalUserChanged","isScreenShareActive","getStreamManager","on","e","videos","video","parentElement","classList","remove","mySession","disconnect","setVideoActive","setAudioActive","nickname","getNickname","deleteSubscriber","stream","remoteUsers","userStream","filter","index","indexOf","splice","_this6","subscriber","subscribe","checkSomeoneShareScreen","newUser","setType","data","split","JSON","parse","push","_this7","setTimeout","preventDefault","_this8","forEach","getConnectionId","from","_this9","signalOptions","stringify","type","signal","fs","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","_this10","navigator","userAgent","mirror","name","showExtensionDialog","once","unpublish","isScreenShared","some","openviduLayoutOptions","setLayoutOptions","property","display","messageReceived","offsetWidth","render","createElement","className","id","sessionId","showNotification","showDialog","cancelClicked","handleNickname","map","sub","streamId","streamManager","style","close","_this11","createSession","createToken","_this12","Promise","resolve","reject","customSessionId","post","headers","Authorization","btoa","response","assign","warn","confirm","_this13"],"mappings":"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","sourcesContent":["var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport './VideoRoomComponent.css';\nimport { OpenVidu } from 'openvidu-browser';\nimport StreamComponent from './stream/StreamComponent';\nimport DialogExtensionComponent from './dialog-extension/DialogExtension';\nimport ChatComponent from './chat/ChatComponent';\n\nimport OpenViduLayout from '../layout/openvidu-layout';\nimport UserModel from '../models/user-model';\nimport ToolbarComponent from './toolbar/ToolbarComponent';\n\nvar localUser = new UserModel();\n\nvar VideoRoomComponent = function (_Component) {\n    _inherits(VideoRoomComponent, _Component);\n\n    function VideoRoomComponent(props) {\n        _classCallCheck(this, VideoRoomComponent);\n\n        var _this = _possibleConstructorReturn(this, (VideoRoomComponent.__proto__ || Object.getPrototypeOf(VideoRoomComponent)).call(this, props));\n\n        _this.OPENVIDU_SERVER_URL = _this.props.openviduServerUrl ? _this.props.openviduServerUrl : 'https://' + window.location.hostname + ':4443';\n        _this.OPENVIDU_SERVER_SECRET = _this.props.openviduSecret ? _this.props.openviduSecret : 'MY_SECRET';\n        _this.hasBeenUpdated = false;\n        _this.layout = new OpenViduLayout();\n        var sessionName = _this.props.sessionName ? _this.props.sessionName : 'SessionA';\n        var userName = _this.props.user ? _this.props.user : 'OpenVidu_User' + Math.floor(Math.random() * 100);\n        _this.state = {\n            mySessionId: sessionName,\n            myUserName: userName,\n            session: undefined,\n            localUser: undefined,\n            subscribers: [],\n            chatDisplay: 'none'\n        };\n\n        _this.joinSession = _this.joinSession.bind(_this);\n        _this.leaveSession = _this.leaveSession.bind(_this);\n        _this.onbeforeunload = _this.onbeforeunload.bind(_this);\n        _this.updateLayout = _this.updateLayout.bind(_this);\n        _this.camStatusChanged = _this.camStatusChanged.bind(_this);\n        _this.micStatusChanged = _this.micStatusChanged.bind(_this);\n        _this.nicknameChanged = _this.nicknameChanged.bind(_this);\n        _this.toggleFullscreen = _this.toggleFullscreen.bind(_this);\n        _this.screenShare = _this.screenShare.bind(_this);\n        _this.stopScreenShare = _this.stopScreenShare.bind(_this);\n        _this.closeDialogExtension = _this.closeDialogExtension.bind(_this);\n        _this.toggleChat = _this.toggleChat.bind(_this);\n        _this.checkNotification = _this.checkNotification.bind(_this);\n        _this.checkSize = _this.checkSize.bind(_this);\n        return _this;\n    }\n\n    _createClass(VideoRoomComponent, [{\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            var openViduLayoutOptions = {\n                maxRatio: 3 / 2, // The narrowest ratio that will be used (default 2x3)\n                minRatio: 9 / 16, // The widest ratio that will be used (default 16x9)\n                fixedRatio: false, // If this is true then the aspect ratio of the video is maintained and minRatio and maxRatio are ignored (default false)\n                bigClass: 'OV_big', // The class to add to elements that should be sized bigger\n                bigPercentage: 0.8, // The maximum percentage of space the big ones should take up\n                bigFixedRatio: false, // fixedRatio for the big ones\n                bigMaxRatio: 3 / 2, // The narrowest ratio to use for the big elements (default 2x3)\n                bigMinRatio: 9 / 16, // The widest ratio to use for the big elements (default 16x9)\n                bigFirst: true, // Whether to place the big one in the top left (true) or bottom right\n                animate: true // Whether you want to animate the transitions\n            };\n\n            this.layout.initLayoutContainer(document.getElementById('layout'), openViduLayoutOptions);\n            window.addEventListener('beforeunload', this.onbeforeunload);\n            window.addEventListener('resize', this.updateLayout);\n            window.addEventListener('resize', this.checkSize);\n            this.joinSession();\n        }\n    }, {\n        key: 'componentWillUnmount',\n        value: function componentWillUnmount() {\n            window.removeEventListener('beforeunload', this.onbeforeunload);\n            window.removeEventListener('resize', this.updateLayout);\n            window.removeEventListener('resize', this.checkSize);\n            this.leaveSession();\n        }\n    }, {\n        key: 'onbeforeunload',\n        value: function onbeforeunload(event) {\n            this.leaveSession();\n        }\n    }, {\n        key: 'joinSession',\n        value: function joinSession() {\n            var _this2 = this;\n\n            this.OV = new OpenVidu();\n\n            this.setState({\n                session: this.OV.initSession()\n            }, function () {\n                _this2.subscribeToStreamCreated();\n\n                _this2.connectToSession();\n            });\n        }\n    }, {\n        key: 'connectToSession',\n        value: function connectToSession() {\n            var _this3 = this;\n\n            if (this.props.token !== undefined) {\n                console.log('token received: ', this.props.token);\n                this.connect(this.props.token);\n            } else {\n                this.getToken().then(function (token) {\n                    console.log(token);\n                    _this3.connect(token);\n                }).catch(function (error) {\n                    if (_this3.props.error) {\n                        _this3.props.error({ error: error.error, messgae: error.message, code: error.code, status: error.status });\n                    }\n                    console.log('There was an error getting the token:', error.code, error.message);\n                    alert('There was an error getting the token:', error.message);\n                });\n            }\n        }\n    }, {\n        key: 'connect',\n        value: function connect(token) {\n            var _this4 = this;\n\n            this.state.session.connect(token, { clientData: this.state.myUserName }).then(function () {\n                _this4.connectWebCam();\n            }).catch(function (error) {\n                if (_this4.props.error) {\n                    _this4.props.error({ error: error.error, messgae: error.message, code: error.code, status: error.status });\n                }\n                alert('There was an error connecting to the session:', error.message);\n                console.log('There was an error connecting to the session:', error.code, error.message);\n            });\n        }\n    }, {\n        key: 'connectWebCam',\n        value: function connectWebCam() {\n            var _this5 = this;\n\n            var publisher = this.OV.initPublisher(undefined, {\n                audioSource: undefined,\n                videoSource: undefined,\n                publishAudio: localUser.isAudioActive(),\n                publishVideo: localUser.isVideoActive(),\n                resolution: '640x480',\n                frameRate: 30,\n                insertMode: 'APPEND'\n            });\n\n            if (this.state.session.capabilities.publish) {\n                this.state.session.publish(publisher).then(function () {\n                    if (_this5.props.joinSession) {\n                        _this5.props.joinSession();\n                    }\n                });\n            }\n            localUser.setNickname(this.state.myUserName);\n            localUser.setConnectionId(this.state.session.connection.connectionId);\n            localUser.setScreenShareActive(false);\n            localUser.setStreamManager(publisher);\n            this.subscribeToUserChanged();\n            this.subscribeToStreamDestroyed();\n            this.sendSignalUserChanged({ isScreenShareActive: localUser.isScreenShareActive() });\n\n            this.setState({ localUser: localUser }, function () {\n                _this5.state.localUser.getStreamManager().on('streamPlaying', function (e) {\n                    _this5.updateLayout();\n                    publisher.videos[0].video.parentElement.classList.remove('custom-class');\n                });\n            });\n        }\n    }, {\n        key: 'leaveSession',\n        value: function leaveSession() {\n            var mySession = this.state.session;\n\n            if (mySession) {\n                mySession.disconnect();\n            }\n\n            // Empty all properties...\n            this.OV = null;\n            this.setState({\n                session: undefined,\n                subscribers: [],\n                mySessionId: 'SessionA',\n                myUserName: 'OpenVidu_User' + Math.floor(Math.random() * 100),\n                localUser: undefined\n            });\n            if (this.props.leaveSession) {\n                this.props.leaveSession();\n            }\n        }\n    }, {\n        key: 'camStatusChanged',\n        value: function camStatusChanged() {\n            localUser.setVideoActive(!localUser.isVideoActive());\n            localUser.getStreamManager().publishVideo(localUser.isVideoActive());\n            this.sendSignalUserChanged({ isVideoActive: localUser.isVideoActive() });\n            this.setState({ localUser: localUser });\n        }\n    }, {\n        key: 'micStatusChanged',\n        value: function micStatusChanged() {\n            localUser.setAudioActive(!localUser.isAudioActive());\n            localUser.getStreamManager().publishAudio(localUser.isAudioActive());\n            this.sendSignalUserChanged({ isAudioActive: localUser.isAudioActive() });\n            this.setState({ localUser: localUser });\n        }\n    }, {\n        key: 'nicknameChanged',\n        value: function nicknameChanged(nickname) {\n            var localUser = this.state.localUser;\n            localUser.setNickname(nickname);\n            this.setState({ localUser: localUser });\n            this.sendSignalUserChanged({ nickname: this.state.localUser.getNickname() });\n        }\n    }, {\n        key: 'deleteSubscriber',\n        value: function deleteSubscriber(stream) {\n            var remoteUsers = this.state.subscribers;\n            var userStream = remoteUsers.filter(function (user) {\n                return user.getStreamManager().stream === stream;\n            })[0];\n            var index = remoteUsers.indexOf(userStream, 0);\n            if (index > -1) {\n                remoteUsers.splice(index, 1);\n                this.setState({\n                    subscribers: remoteUsers\n                });\n            }\n        }\n    }, {\n        key: 'subscribeToStreamCreated',\n        value: function subscribeToStreamCreated() {\n            var _this6 = this;\n\n            this.state.session.on('streamCreated', function (event) {\n                var subscriber = _this6.state.session.subscribe(event.stream, undefined);\n                var subscribers = _this6.state.subscribers;\n                subscriber.on('streamPlaying', function (e) {\n                    _this6.checkSomeoneShareScreen();\n                    subscriber.videos[0].video.parentElement.classList.remove('custom-class');\n                });\n                var newUser = new UserModel();\n                newUser.setStreamManager(subscriber);\n                newUser.setConnectionId(event.stream.connection.connectionId);\n                newUser.setType('remote');\n                var nickname = event.stream.connection.data.split('%')[0];\n                newUser.setNickname(JSON.parse(nickname).clientData);\n                subscribers.push(newUser);\n                _this6.setState({\n                    subscribers: subscribers\n                }, function () {\n                    if (_this6.state.localUser) {\n                        _this6.sendSignalUserChanged({\n                            isAudioActive: _this6.state.localUser.isAudioActive(),\n                            isVideoActive: _this6.state.localUser.isVideoActive(),\n                            nickname: _this6.state.localUser.getNickname(),\n                            isScreenShareActive: _this6.state.localUser.isScreenShareActive()\n                        });\n                    }\n                    _this6.updateLayout();\n                });\n            });\n        }\n    }, {\n        key: 'subscribeToStreamDestroyed',\n        value: function subscribeToStreamDestroyed() {\n            var _this7 = this;\n\n            // On every Stream destroyed...\n            this.state.session.on('streamDestroyed', function (event) {\n                // Remove the stream from 'subscribers' array\n                _this7.deleteSubscriber(event.stream);\n                setTimeout(function () {\n                    _this7.checkSomeoneShareScreen();\n                }, 20);\n                event.preventDefault();\n                _this7.updateLayout();\n            });\n        }\n    }, {\n        key: 'subscribeToUserChanged',\n        value: function subscribeToUserChanged() {\n            var _this8 = this;\n\n            this.state.session.on('signal:userChanged', function (event) {\n                var remoteUsers = _this8.state.subscribers;\n                remoteUsers.forEach(function (user) {\n                    if (user.getConnectionId() === event.from.connectionId) {\n                        var data = JSON.parse(event.data);\n                        console.log('EVENTO REMOTE: ', event.data);\n                        if (data.isAudioActive !== undefined) {\n                            user.setAudioActive(data.isAudioActive);\n                        }\n                        if (data.isVideoActive !== undefined) {\n                            user.setVideoActive(data.isVideoActive);\n                        }\n                        if (data.nickname !== undefined) {\n                            user.setNickname(data.nickname);\n                        }\n                        if (data.isScreenShareActive !== undefined) {\n                            user.setScreenShareActive(data.isScreenShareActive);\n                        }\n                    }\n                });\n                _this8.setState({\n                    subscribers: remoteUsers\n                }, function () {\n                    return _this8.checkSomeoneShareScreen();\n                });\n            });\n        }\n    }, {\n        key: 'updateLayout',\n        value: function updateLayout() {\n            var _this9 = this;\n\n            setTimeout(function () {\n                _this9.layout.updateLayout();\n            }, 20);\n        }\n    }, {\n        key: 'sendSignalUserChanged',\n        value: function sendSignalUserChanged(data) {\n            var signalOptions = {\n                data: JSON.stringify(data),\n                type: 'userChanged'\n            };\n            this.state.session.signal(signalOptions);\n        }\n    }, {\n        key: 'toggleFullscreen',\n        value: function toggleFullscreen() {\n            var document = window.document;\n            var fs = document.getElementById('container');\n            if (!document.fullscreenElement && !document.mozFullScreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement) {\n                if (fs.requestFullscreen) {\n                    fs.requestFullscreen();\n                } else if (fs.msRequestFullscreen) {\n                    fs.msRequestFullscreen();\n                } else if (fs.mozRequestFullScreen) {\n                    fs.mozRequestFullScreen();\n                } else if (fs.webkitRequestFullscreen) {\n                    fs.webkitRequestFullscreen();\n                }\n            } else {\n                if (document.exitFullscreen) {\n                    document.exitFullscreen();\n                } else if (document.msExitFullscreen) {\n                    document.msExitFullscreen();\n                } else if (document.mozCancelFullScreen) {\n                    document.mozCancelFullScreen();\n                } else if (document.webkitExitFullscreen) {\n                    document.webkitExitFullscreen();\n                }\n            }\n        }\n    }, {\n        key: 'screenShare',\n        value: function screenShare() {\n            var _this10 = this;\n\n            var videoSource = navigator.userAgent.indexOf('Firefox') !== -1 ? 'window' : 'screen';\n            var publisher = this.OV.initPublisher(undefined, {\n                videoSource: videoSource,\n                publishAudio: localUser.isAudioActive(),\n                publishVideo: localUser.isVideoActive(),\n                mirror: false\n            }, function (error) {\n                if (error && error.name === 'SCREEN_EXTENSION_NOT_INSTALLED') {\n                    _this10.setState({ showExtensionDialog: true });\n                } else if (error && error.name === 'SCREEN_SHARING_NOT_SUPPORTED') {\n                    alert('Your browser does not support screen sharing');\n                } else if (error && error.name === 'SCREEN_EXTENSION_DISABLED') {\n                    alert('You need to enable screen sharing extension');\n                } else if (error && error.name === 'SCREEN_CAPTURE_DENIED') {\n                    alert('You need to choose a window or application to share');\n                }\n            });\n\n            publisher.once('accessAllowed', function () {\n                _this10.state.session.unpublish(localUser.getStreamManager());\n                localUser.setStreamManager(publisher);\n                _this10.state.session.publish(localUser.getStreamManager()).then(function () {\n                    localUser.setScreenShareActive(true);\n                    _this10.setState({ localUser: localUser }, function () {\n                        _this10.sendSignalUserChanged({ isScreenShareActive: localUser.isScreenShareActive() });\n                    });\n                });\n            });\n            publisher.on('streamPlaying', function () {\n                _this10.updateLayout();\n                publisher.videos[0].video.parentElement.classList.remove('custom-class');\n            });\n        }\n    }, {\n        key: 'closeDialogExtension',\n        value: function closeDialogExtension() {\n            this.setState({ showExtensionDialog: false });\n        }\n    }, {\n        key: 'stopScreenShare',\n        value: function stopScreenShare() {\n            this.state.session.unpublish(localUser.getStreamManager());\n            this.connectWebCam();\n        }\n    }, {\n        key: 'checkSomeoneShareScreen',\n        value: function checkSomeoneShareScreen() {\n            var isScreenShared = void 0;\n            // return true if at least one passes the test\n            isScreenShared = this.state.subscribers.some(function (user) {\n                return user.isScreenShareActive();\n            }) || localUser.isScreenShareActive();\n            var openviduLayoutOptions = {\n                maxRatio: 3 / 2,\n                minRatio: 9 / 16,\n                fixedRatio: isScreenShared,\n                bigClass: 'OV_big',\n                bigPercentage: 0.8,\n                bigFixedRatio: false,\n                bigMaxRatio: 3 / 2,\n                bigMinRatio: 9 / 16,\n                bigFirst: true,\n                animate: true\n            };\n            this.layout.setLayoutOptions(openviduLayoutOptions);\n            this.updateLayout();\n        }\n    }, {\n        key: 'toggleChat',\n        value: function toggleChat(property) {\n            var display = property;\n\n            if (display === undefined) {\n                display = this.state.chatDisplay === 'none' ? 'block' : 'none';\n            }\n            if (display === 'block') {\n                this.setState({ chatDisplay: display, messageReceived: false });\n            } else {\n                console.log('chat', display);\n                this.setState({ chatDisplay: display });\n            }\n            this.updateLayout();\n        }\n    }, {\n        key: 'checkNotification',\n        value: function checkNotification(event) {\n            this.setState({\n                messageReceived: this.state.chatDisplay === 'none'\n            });\n        }\n    }, {\n        key: 'checkSize',\n        value: function checkSize() {\n            if (document.getElementById('layout').offsetWidth <= 700 && !this.hasBeenUpdated) {\n                this.toggleChat('none');\n                this.hasBeenUpdated = true;\n            }\n            if (document.getElementById('layout').offsetWidth > 700 && this.hasBeenUpdated) {\n                this.hasBeenUpdated = false;\n            }\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var mySessionId = this.state.mySessionId;\n            var localUser = this.state.localUser;\n            var chatDisplay = { display: this.state.chatDisplay };\n\n            return React.createElement(\n                'div',\n                { className: 'container', id: 'container' },\n                React.createElement(ToolbarComponent, {\n                    sessionId: mySessionId,\n                    user: localUser,\n                    showNotification: this.state.messageReceived,\n                    camStatusChanged: this.camStatusChanged,\n                    micStatusChanged: this.micStatusChanged,\n                    screenShare: this.screenShare,\n                    stopScreenShare: this.stopScreenShare,\n                    toggleFullscreen: this.toggleFullscreen,\n                    leaveSession: this.leaveSession,\n                    toggleChat: this.toggleChat\n                }),\n                React.createElement(DialogExtensionComponent, { showDialog: this.state.showExtensionDialog, cancelClicked: this.closeDialogExtension }),\n                React.createElement(\n                    'div',\n                    { id: 'layout', className: 'bounds' },\n                    localUser !== undefined && localUser.getStreamManager() !== undefined && React.createElement(\n                        'div',\n                        { className: 'OT_root OT_publisher custom-class', id: 'localUser' },\n                        React.createElement(StreamComponent, { user: localUser, handleNickname: this.nicknameChanged })\n                    ),\n                    this.state.subscribers.map(function (sub, i) {\n                        return React.createElement(\n                            'div',\n                            { key: i, className: 'OT_root OT_publisher custom-class', id: 'remoteUsers' },\n                            React.createElement(StreamComponent, { user: sub, streamId: sub.streamManager.stream.streamId })\n                        );\n                    }),\n                    localUser !== undefined && localUser.getStreamManager() !== undefined && React.createElement(\n                        'div',\n                        { className: 'OT_root OT_publisher custom-class', style: chatDisplay },\n                        React.createElement(ChatComponent, {\n                            user: localUser,\n                            chatDisplay: this.state.chatDisplay,\n                            close: this.toggleChat,\n                            messageReceived: this.checkNotification\n                        })\n                    )\n                )\n            );\n        }\n\n        /**\n         * --------------------------\n         * SERVER-SIDE RESPONSIBILITY\n         * --------------------------\n         * These methods retrieve the mandatory user token from OpenVidu Server.\n         * This behaviour MUST BE IN YOUR SERVER-SIDE IN PRODUCTION (by using\n         * the API REST, openvidu-java-client or openvidu-node-client):\n         *   1) Initialize a session in OpenVidu Server\t(POST /api/sessions)\n         *   2) Generate a token in OpenVidu Server\t\t(POST /api/tokens)\n         *   3) The token must be consumed in Session.connect() method\n         */\n\n    }, {\n        key: 'getToken',\n        value: function getToken() {\n            var _this11 = this;\n\n            return this.createSession(this.state.mySessionId).then(function (sessionId) {\n                return _this11.createToken(sessionId);\n            });\n        }\n    }, {\n        key: 'createSession',\n        value: function createSession(sessionId) {\n            var _this12 = this;\n\n            return new Promise(function (resolve, reject) {\n                var data = JSON.stringify({ customSessionId: sessionId });\n                axios.post(_this12.OPENVIDU_SERVER_URL + '/api/sessions', data, {\n                    headers: {\n                        Authorization: 'Basic ' + btoa('OPENVIDUAPP:' + _this12.OPENVIDU_SERVER_SECRET),\n                        'Content-Type': 'application/json'\n                    }\n                }).then(function (response) {\n                    console.log('CREATE SESION', response);\n                    resolve(response.data.id);\n                }).catch(function (response) {\n                    var error = Object.assign({}, response);\n                    if (error.response && error.response.status === 409) {\n                        resolve(sessionId);\n                    } else {\n                        console.log(error);\n                        console.warn('No connection to OpenVidu Server. This may be a certificate error at ' + _this12.OPENVIDU_SERVER_URL);\n                        if (window.confirm('No connection to OpenVidu Server. This may be a certificate error at \"' + _this12.OPENVIDU_SERVER_URL + '\"\\n\\nClick OK to navigate and accept it. ' + 'If no certificate warning is shown, then check that your OpenVidu Server is up and running at \"' + _this12.OPENVIDU_SERVER_URL + '\"')) {\n                            window.location.assign(_this12.OPENVIDU_SERVER_URL + '/accept-certificate');\n                        }\n                    }\n                });\n            });\n        }\n    }, {\n        key: 'createToken',\n        value: function createToken(sessionId) {\n            var _this13 = this;\n\n            return new Promise(function (resolve, reject) {\n                var data = JSON.stringify({ session: sessionId });\n                axios.post(_this13.OPENVIDU_SERVER_URL + '/api/tokens', data, {\n                    headers: {\n                        Authorization: 'Basic ' + btoa('OPENVIDUAPP:' + _this13.OPENVIDU_SERVER_SECRET),\n                        'Content-Type': 'application/json'\n                    }\n                }).then(function (response) {\n                    console.log('TOKEN', response);\n                    resolve(response.data.token);\n                }).catch(function (error) {\n                    return reject(error);\n                });\n            });\n        }\n    }]);\n\n    return VideoRoomComponent;\n}(Component);\n\nexport default VideoRoomComponent;"]},"metadata":{},"sourceType":"module"}